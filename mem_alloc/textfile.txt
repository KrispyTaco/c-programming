Most of the code seems to be in working order, except for the free function...for some reason it increases the amount of memory leakage as opposed to decreasing the amount.  This reason is unknown...
